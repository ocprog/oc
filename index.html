<!-- c:\Users\sakamoto\python\testing_test\test99_etc\11-vr\index.html -->
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>VR Controller Test</title>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <!-- 新しいスクリプトファイルを読み込み -->
    <script src="simple-game.js"></script>
</head>
<body>
    <a-scene background="color: #222">
        <a-assets>
            <!-- 効果音: ここを好きなmp3ファイルのURLに変えると音が変わります -->
            <audio id="explode-sound" src="https://cdn.aframe.io/scavenger-hunt/points.mp3" preload="auto"></audio>
            <!-- ボム音 -->
            <audio id="bomb-sound" src="https://cdn.aframe.io/scavenger-hunt/whistle.mp3" preload="auto"></audio>
            <!-- バウンド音 -->
            <audio id="bounce-sound" src="https://cdn.aframe.io/scavenger-hunt/pop.mp3" preload="auto"></audio>
        </a-assets>
        
        <!-- プレイヤーリグ（カメラと手） -->
        <a-entity id="rig" position="0 0 0">
            <!-- 視点を少し高く(Y=2.3)、後ろ(Z=1.0)にして、斜め上から見下ろす感じにする -->
            <a-camera position="0 2.3 1.0" rotation="-20 0 0"></a-camera>
            
            <!-- プレイヤーのバー（パドル）: 目の前に表示され、リグと一緒に左右に動く -->
            <a-box id="paddle" color="#00AAFF" width="2.5" height="0.1" depth="0.1" position="0 1.0 -1" material="opacity: 0.3; transparent: true"></a-box>
            
            <!-- 左手: 手のモデルを表示。ボタンを押すとログが出る -->
            <a-entity id="leftHand" 
                      hand-controls="hand: left; handModelStyle: lowPoly; color: #ffcccc"
                      oculus-touch-controls="hand: left; model: false"
                      game-controls="hand: left">
            </a-entity>

            <!-- 右手: レーザーポインターを表示。敵をクリックできる -->
            <a-entity id="rightHand" 
                      laser-controls="hand: right" 
                      raycaster="objects: .clickable; far: 50"
                      line="color: cyan; opacity: 0.75"
                      oculus-touch-controls="hand: right; model: false"
                      game-controls="hand: right">
            </a-entity>
        </a-entity>

        <!-- UI: 画面正面にログとスコアを表示 -->
        <a-entity position="0 3 -4">
            <!-- 背景パネル -->
            <a-plane width="4" height="2.5" color="#000" opacity="0.7"></a-plane>
            
            <!-- スコア -->
            <a-text id="score-text" value="Score: 0" align="center" position="0 0.8 0.01" scale="2 2 2" color="#FFF"></a-text>
            
            <!-- HP -->
            <a-text id="hp-text" value="HP: 3" align="center" position="0 0.3 0.01" scale="2 2 2" color="#FF4444"></a-text>
            
            <!-- ミサイル残弾 -->
            <a-text id="missile-text" value="MISSILE: 0" align="center" position="0 -0.2 0.01" scale="2 2 2" color="#FFFF00"></a-text>
            
            <!-- 操作説明 -->
            <a-text id="log-text" value="L-Stick: Move Left/Right" align="center" position="0 -0.6 0.01" color="#AAA" scale="0.8 0.8 0.8"></a-text>

            <!-- リスタートボタン (初期は非表示) -->
            <a-entity id="restart-button" position="0 -0.8 0.1" visible="false">
                <a-plane id="restart-click-target" class="clickable" width="2" height="0.6" color="#228822"
                         animation__mouseenter="property: scale; to: 1.1 1.1 1.1; dur: 100; startEvents: mouseenter"
                         animation__mouseleave="property: scale; to: 1 1 1; dur: 100; startEvents: mouseleave"></a-plane>
                <a-text value="RESTART" align="center" position="0 0 0.01" scale="2 2 2"></a-text>
            </a-entity>
        </a-entity>

        <!-- ゲーム管理（敵生成など） -->
        <a-entity game-manager></a-entity>

        <!-- 地面 -->
        <a-plane position="0 0 0" rotation="-90 0 0" width="20" height="20" color="#444"></a-plane>
        <a-grid helper geometry="primitive: plane; width: 20; height: 20" rotation="-90 0 0" material="src: url(https://cdn.aframe.io/a-painter/images/floor.jpg); repeat: 10 10; transparent: true; opacity: 0.5"></a-grid>
        
        <!-- 照明 -->
        <a-light type="ambient" color="#444"></a-light>
        <a-light type="directional" position="-1 2 1" intensity="0.8"></a-light>

    </a-scene>
</body>
</html>
